<!DOCTYPE html>
<html>
<head>
    <title>HUNTING - Three.js Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #050505; font-family: 'Courier New', monospace; }
        #overlay { position: absolute; bottom: 20px; left: 20px; color: white; text-shadow: 2px 2px black; }
        #menu { position: absolute; width: 100%; height: 100%; background: black; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5; }
        button { background: #222; color: white; border: 1px solid white; padding: 10px 20px; cursor: pointer; }
    </style>
</head>
<body>
    <div id="menu">
        <h1>HUNTING</h1>
        <p>Use WASD to Move | Mouse to Look | Click to Start</p>
        <button onclick="start()">BEGIN HUNT</button>
    </div>
    <div id="overlay">DEER HUNTED: <span id="score">0</span></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, score = 0;
        let moveFwd = false, moveBwd = false, moveL = false, moveR = false;
        let deerArray = [];

        function start() {
            document.getElementById('menu').style.display = 'none';
            document.body.requestPointerLock();
        }

        scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x050505, 0.15);
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        renderer = new THREE.WebGLRenderer({ antialias: false });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const floor = new THREE.Mesh(
            new THREE.PlaneGeometry(200, 200),
            new THREE.MeshLambertMaterial({ color: 0x112211 })
        );
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);

        const ambient = new THREE.AmbientLight(0x404040, 0.5);
        scene.add(ambient);
        const flashlight = new THREE.SpotLight(0xffffff, 1.5, 20, 0.4);
        camera.add(flashlight);
        flashlight.position.set(0, 0, 1);
        flashlight.target.position.set(0, 0, -1);
        scene.add(camera);
        scene.add(flashlight.target);

        function spawnDeer() {
            const geo = new THREE.BoxGeometry(0.5, 1, 0.5);
            const mat = new THREE.MeshLambertMaterial({ color: 0xffff00 });
            const deer = new THREE.Mesh(geo, mat);
            deer.position.set(Math.random() * 40 - 20, 0.5, Math.random() * 40 - 20);
            scene.add(deer);
            deerArray.push(deer);
        }
        for(let i=0; i<5; i++) spawnDeer();

        document.addEventListener('keydown', (e) => {
            if (e.code === 'KeyW') moveFwd = true;
            if (e.code === 'KeyS') moveBwd = true;
            if (e.code === 'KeyA') moveL = true;
            if (e.code === 'KeyD') moveR = true;
        });
        document.addEventListener('keyup', (e) => {
            if (e.code === 'KeyW') moveFwd = false;
            if (e.code === 'KeyS') moveBwd = false;
            if (e.code === 'KeyA') moveL = false;
            if (e.code === 'KeyD') moveR = false;
        });
        document.addEventListener('mousemove', (e) => {
            if (document.pointerLockElement) {
                camera.rotation.y -= e.movementX * 0.002;
                camera.rotation.x -= e.movementY * 0.002;
            }
        });
        camera.rotation.order = 'YXZ';

        function animate() {
            requestAnimationFrame(animate);

            const dir = new THREE.Vector3();
            camera.getWorldDirection(dir);
            dir.y = 0; dir.normalize();
            const side = new THREE.Vector3().crossVectors(camera.up, dir).normalize();

            if (moveFwd) camera.position.addScaledVector(dir, 0.1);
            if (moveBwd) camera.position.addScaledVector(dir, -0.1);
            if (moveL) camera.position.addScaledVector(side, 0.1);
            if (moveR) camera.position.addScaledVector(side, -0.1);

            deerArray.forEach((deer, index) => {
                if (camera.position.distanceTo(deer.position) < 1.5) {
                    scene.remove(deer);
                    deerArray.splice(index, 1);
                    score++;
                    document.getElementById('score').innerText = score;
                    spawnDeer();
                    
                    if(score > 5) {
                        scene.fog.color.set(0x220000);
                        renderer.setClearColor(0x220000);
                    }
                }
            });

            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
